<html>
<head>
	
<title>RCHGetElementNumber() -- Documentation</title>

</head>

<body>
<h2>Documentation for RCHGetElementNumber() function</h2>

<br><u><b>Description</b></u>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Returns a specific data element from a specified data source (i.e. web page).

<br><br><u><b>Syntax</b></u>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>=RCHGetElementNumber( ticker , elementnumber [, errorvalue ] )</b>

<br><br><u><b>Parameters</b></u><br><br>
<table>
<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign=top><b>ticker</b></td><td valign=top>=</td><td>
A ticker symbol indicating which company data is to be returned for.  In addition, there are several literals that can be specified for this parameter to request other information.  See the "Examples" section for more details.
<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign=top><b>elementnumber</b></td><td valign=top>=</td><td>
A number specifying which data element is to be retrieved for a ticker symbol.  A list of element numbers and the data sources and data elements they are related to can be found in the RCHGetElementNumber-Element-Definitions.xls workbook distributed with the add-in.
<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign=top><b>errorvalue</b></td><td valign=top>=</td><td>
A string or numeric value to be returned if there is an error in finding the data element.  A default value of "error" is used if nothing is passed.  This can prevent needing to put IF() statements in a cell to make a display or calculation of items easier to read.

</td></tr>
</table>

<br><u><b>Examples</b></u><br><br>
<table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td>
<table border=1>
<tr><td nowrap><b>Example Formula</b></td><td nowrap><b>Value Returned</b></td><td><b>Description</b></td></tr>
<tr><td nowrap>=RCHGetElementNumber("Version")</td><td nowrap>Stock Market Functions add-in, Version 2.0j</td><td>Tells you which version of the add-in you are using.</td></tr>
<tr><td nowrap>=RCHGetElementNumber("Source",941)</td><td nowrap>YahooKS</td><td>Gives you the data source for element number 941</td></tr>
<tr><td nowrap>=RCHGetElementNumber("Element",941)</td><td nowrap>Market Cap</td><td>Gives you the element name for element number 941</td></tr>
<tr><td nowrap>=RCHGetElementNumber("Web Page",941)</td><td nowrap>http://finance.yahoo.com/q/ks?s=~~~~~</td><td>Gives you the web page element number 941 is retrieved from ("~~~~~" is the ticker symbol)</td></tr>
<tr><td nowrap>=RCHGetElementNumber("IBM", 941)</td><td nowrap>119,670,000</td><td>Market Capitalization from data source "YahooKS" for ticker "IBM"</td></tr>
<tr><td nowrap>=RCHGetElementNumber("IBM", 1541)</td><td nowrap>119,670,000,000</td><td>Market Capitalization from data source "MSN" for ticker "IBM"</td></tr>
<tr><td colspan=3>&nbsp;</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-URL",941)</td><td nowrap>http://finance.yahoo.com/q/ks?s=~~~~~</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Cells",941)</td><td nowrap>1</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Find1",941)</td><td nowrap>VALUATION MEASURES</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Find2",941)</td><td nowrap>MARKET CAP</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Find3",941)</td><td nowrap>&nbsp;</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Find4",941)</td><td nowrap>&nbsp;</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Rows",941)</td><td nowrap>0</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-End",941)</td><td nowrap>0</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Look",941)</td><td nowrap>0</td><td>RCHGetTableCell() function parameter</td></tr>
<tr><td nowrap>=RCHGetElementNumber("P-Type",941)</td><td nowrap>0</td><td>RCHGetTableCell() function parameter</td></tr>
</table></td></tr></table>

<br><u><b>Usage notes</b></u>
<ul>
<li>When elements are retrieved, the source code of the web page is saved in an array within the VBA environment, then the element is extracted from that source code.  It is done that way so that when a number of elements are retrieved from the same web page, the web page only needs to be retrieved once.  Note that the array to save web pages is limited to 1000 pages.  Anything beyond that will get an error message.  The entire array can be reset by either exiting and re-entering EXCEL or by running the smfForceRecalculation macro.  This macro purges all saved web pages and reacalculates all functions.
<br><br><li>...coming later...
</ul>


</body>
</html>
