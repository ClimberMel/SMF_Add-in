<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	
<title>RCHGetYahooHistory() -- Documentation</title>

</head>

<body>

<h2>Documentation for RCHGetYahooHistory() function</h2>

<br><u><b>Description</b></u>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Returns historical stock quotes from the Yahoo quotes interface.

<br><br><u><b>Syntax</b></u>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<b>=RCHGetYahooHistory( Ticker, [Start 
Year], [Start Month], [Start Day], [End Year], [End Month], [End Day], 
[Period], [Data Items], [Header Line], [Adjust], [Resort] )</b>


<br><br><u><b>Parameters</b></u><br><br>
<table>

<tbody><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Ticker</b></td><td valign="top">=</td><td>
Ticker symbol (e.g "MMM")<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Start Year</b></td><td valign="top">=</td><td>
Year to use as the starting date of the historical quotes; must be four 
digits (e.g. 2022); optional; default is to fill your array-entered 
range.<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Start Month</b></td><td valign="top">=</td><td>
Month to use as the starting date of the historical quotes; optional; default is to fill your array-entered range.<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Start Day</b></td><td valign="top">=</td><td>
Day to use as the starting date of the historical quotes; optional; default is to fill your array-entered range.<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>End Year</b></td><td valign="top">=</td><td>
Year to use as the ending date of the historical quotes; must be four 
digits (e.g. 2023); optional; defaults to most recent date available.<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>End Month</b></td><td valign="top">=</td><td>
Month to use as the ending date of the historical quotes; optional; defaults to most recent date available.<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>End Day</b></td><td valign="top">=</td><td>
Day to use as the ending date of the historical quotes; optional; defaults to most recent date available.<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Period</b></td><td valign="top">=</td><td>
Type of data period to retrieve; optional; defaults to "d"; possible values:
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;"d" = Daily quotes
<br>&nbsp;&nbsp;&nbsp;&nbsp;"w" = Weekly quotes  (Yahoo chooses to use the first trading day of the week as the end of the period)
<br>&nbsp;&nbsp;&nbsp;&nbsp;"m" = Monthly quotes (Yahoo chooses to use the first trading day of the month as the end of the period)
<br>&nbsp;&nbsp;&nbsp;&nbsp;"v" = Dividend history ("T" is the only 
"Data Item" that makes a difference ï¿½ Date and Dividend amount are 
automatic)
<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Data Items</b></td><td valign="top">=</td><td>
A character string indicating which data items to retrieve; optional; 
defaults to "DOHLCVA"; possible values within the character string:
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;"T" = Ticker symbol
<br>&nbsp;&nbsp;&nbsp;&nbsp;"D" = Ending date of the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"O" = Opening price of the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"H" = High price for the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"L" = Low price for the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"C" = Adjusted Closing price for the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"V" = Trading volume for the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"U" = Adjusted closing price for the period
<br>&nbsp;&nbsp;&nbsp;&nbsp;"A" = Accepted as input but same as C - Adjusted close (only one will display)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If C and A are provided, A will be dropped
<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Header Line</b></td><td valign="top">=</td><td>
A binary value to indicate whether headers should be returned for the 
column(s) of data; optional; defaults to 1; possible values:
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;0 = Delete column headings
<br>&nbsp;&nbsp;&nbsp;&nbsp;1 = Display column headings
<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Adjust</b></td><td valign="top">=</td><td>
A binary value to indicate whether data should be adjusted or not; optional; defaults to 1.  Left in for compatibility.
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;0 = Do not attempt to adjust data; now returns error if used
<br>&nbsp;&nbsp;&nbsp;&nbsp;1 = Returns data as adjusted by Yahoo
<br><br></td></tr>

<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top"><b>Resort</b></td><td valign="top">=</td><td>
A binary value to indicate whether data should be resorted or not; optional; defaults to 0.
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;0 = Do not resort data; present raw data as 
returned from Yahoo!; newest data will be on the top rows of table.
<br>&nbsp;&nbsp;&nbsp;&nbsp;1 = Reverse the order of data returned from Yahoo!; oldest data will be on the top rows of table.
<br><br></td></tr>

</tbody></table>

<br><u><b>Examples</b></u>
<ul>

<li>This would return the seven default data items for ticker symbol IBM:
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;=RCHGetYahooHistory("IBM")
<br><br>If you array-entered the above formula over a 10-row by 7-column
 range, you would get the D/O/H/L/C/V/U data items for the latest 9 days
 of history.

<br><br></li><li>This would return a single item -- the adjusted closing price for ticker symbol IBM for January 3rd, 2007:
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;=RCHGetYahooHistory("IBM",2023,1,3,2023,1,3,,"C",0)

<br><br></li><li>...more to come

</li></ul>

<u><b>Usage notes</b></u>
<ul>

<li>In most cases, this will need to be an array-entered formula.  To 
array-enter a formula in EXCEL, first highlight the range of cells where
 you would like the returned data to appear -- the number of rows for 
the range should be the number of periods of data you are requesting 
from the function, while the number of columns for the range should be 
the number of data items you are requesting for each date from the 
function.  Next, enter your formula and then press Ctrl-Shift-Enter. 

<br><br></li><li>If the function is array-entered over a range that is 
larger than the amount of data available from Yahoo, the excess portion 
of the range will be filled with blanks.

<br><br></li><li>If the function is array-entered over a range that is 
smaller than the amount of data returned from Yahoo, the excess Yahoo 
data will simply be ignored.  A user-defined function can only return 
data to a cell or a range that it has been given access to -- in this 
case, by the range used when array-entering the function.

<br><br></li><li>...more to come

</li></ul>



</body></html>