<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=windows-1252">
        <title>RCHGetHTMLTable() Documentation</title>
    </head>

<body>

<h2>Documentation for RCHGetHTMLTable() function</h2>

This function is used to extract an HTML table from a web page.<br><br>

    <table>
        <tbody>
            <tr><td colspan="2"><b><u>Syntax:</u></b></td></tr>
            <tr><td colspan="2">&nbsp;</td></tr>
            <tr><td colspan="2">
                    <b>&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable( URL, Find Begin, Begin Direction, Find End, End Direction )</b>
                </td>
            </tr>
            <tr><td colspan="2">&nbsp;</td></tr>
            <tr><td colspan="2"><b><u>where:</u></b></td></tr>
            <tr><td colspan="2">&nbsp;</td></tr>
            <tr><td valign="top"><b>&nbsp;&nbsp;&nbsp;&nbsp;URL</b></td><td>= URL of the web page to retrieve.<br><br></td></tr>
            <tr><td valign="top"><b>&nbsp;&nbsp;&nbsp;&nbsp;Find Begin</b></td>
                <td>= String to search for on web page to find start of table.<br><br></td>
            </tr>
            <tr><td valign="top"><b>&nbsp;&nbsp;&nbsp;&nbsp;Begin Direction</b></td>
                <td>= Number of &lt;TABLE tags to searh for after finding the above string 
                    to find the start of the table.  A negative number indicates to
                    search backwards, positive number forwards.<br><br>
                </td>
            </tr>
            <tr><td valign="top"><b>&nbsp;&nbsp;&nbsp;&nbsp;Find End</b></td>
                <td>= String to search for on web page to find end of table.  
                    If blank, the "<b>Find Begin</b>" parameter will be reused.<br><br>
                </td>
            </tr>
            <tr><td valign="top"><b>&nbsp;&nbsp;&nbsp;&nbsp;End Direction</b></td>
                <td>= Number of &lt;/TABLE tags to searh for after finding the above string 
                    to find the end of the table.  A negative number indicates to
                    search backwards, positive number forwards.<br><br>
                </td>
            </tr>
            <tr>
                <td colspan="2"><b><u>Usage Notes:</u></b>
                    <ul>
                        <li>This function returns an array of data (the HTML table), <mark><b>so it needs
                            to be array-entered</b></mark>.  To array-enter a formula in EXCEL, first 
                            highlight the range of cells where you would like the returned data to 
                            appear -- the number of rows and columns for the range will depend on 
                            the size of the table you are retrieving and how much of that table you 
                            want to see.  Next, enter your formula and then press Ctrl-Shift-Enter.<br><br>
                        </li>
                        <li>What it does -- given this invocation: <br><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("https://finance.yahoo.com/quote/" & C4 & "/analysis?p=" & C4, ">Earnings Est", -1, ">Growth Est", 1)<br><br>
                            The function will:<br><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-- In this example the C4 points to a valid ticker<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-- Retrieve HTML source of the Yahoo! Analysis web page.  <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-- Search for ">Earnings Est" within the source of the web page.<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-- Set the start of the HTML table to be the first "&lt;TABLE" tag prior to that string (i.e. -1).<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-- Set the end of the HTML table to be the first "&lt;/TABLE" tag after that string (i.e. 1).<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-- Return the full table specified by and including the found "&lt;TABLE" and "&lt;/TABLE" tags.
                        </li>
                    </ul>
                </td>
            </tr>
        </tbody>
    </table>
    <img style="float: center"; padding: 100px; src="RCHGetHTMLTable-example.png" height="400px" width="600px" alt="Excel SMF Add-In"/><br><br>
    <table>
        <tbody>
            <tr>
                <td colspan="2"><b><u>Examples:</u></b><br><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<b>These have not been tested recently and may be outdated due to changes by Yahoo to their web pages</b>><br><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q/ks?s=MMM","PEG Ratio",-1,"",1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q?d=t&amp;s=IBM","Volume:",-1,"",1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q/ao?s=IBM",
                    "Mean Recommendation", -3, "Mean Recommendation", 1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q/ao?s=IBM", "Mean Target", -3, "Mean Target", 1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q/ao?s=IBM", "Three Months Ago", -4, "Three Months Ago", 1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q/ud?s=IBM", "Research Firm", -1, "Research Firm", 1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;=RCHGetHTMLTable("http://finance.yahoo.com/q/ae?s=IBM", "&gt;Earnings Est", -2, "&gt;Growth Est", 1)<br><br>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html>